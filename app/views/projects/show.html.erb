<h1><%= @project.title %></h1>


<!-- タグの設定 -->
<div class="panel panel-default">
	<div class="panel-heading">
    	<h3 class="panel-title">タグによる検索<br></h3>
  	</div>
	<div class="panel-body">
		<%= form_for (@project), html: {class: "navbar-form" } do |p_form| %>
			下のリストからタグを選んで入力してください。空にすると、全タグが対象となります。<br>
			補完が効くと良いのですが、うまく動いていないので・・・、すみません。<br>

			<div class="input-group">
				<%= tag(:input, { id: "tokenfield", type: "text", name: "project[tag_list]", value: @project.tag_list.join(", "), class: "form-control" }) %>
				<span class="input-group-btn">
					<button type="submit" class="btn btn-default" name="add_tags">
						<i class="glyphicon glyphicon-plus"></i> 更新
					</button>
				</span>
			</div>

			<br>

			<%= Check.all_tags.join(", ") %>
		<% end %>
	</div>
</div>

<%= form_for (@project), html: {class: "navbar-form" } do |p_form| %>

	<table class="table table-striped table-hover">
		<tbody>
			<% @project.check_results.each do |cr| %>
				<%= p_form.fields_for :check_results, cr do |cr_fields| %>
					<% @checks.where( id: cr.check_id ).each do |c| %>
						<tr>
							<td>
		  						<%= cr_fields.check_box :done, {}, true, cr.done %>
								<%= link_to c.title, check_path(c.id) %>
							</td>

							<td align="right">
								<% c.tags.each do |tag| %>
									<span class="label label-info">
										<%= tag.name %>
									</span>
									&nbsp
								<% end %>
							</td>

							<td align="right">
								<%= cr_fields.text_area :comment, class: "form-control", placeholder: "コメント", size: "30x1" %>
							</td>
						</tr>
						<%= cr_fields.hidden_field :check_id, value: cr.check_id %>
					<% end %>
				<% end %>
			<% end %>
		</tbody>
	</table>

	<!-- 更新ボタン -->
	<!-- 
	<%= p_form.submit 'from_show' %>
 -->
 	<div align="right">
		<%= button_tag(type: 'submit', name: 'from_show', class: "btn btn-default") do %>
			<i class="glyphicon glyphicon-save"></i> Save
		<% end %>
	</div>
<% end %>


<script>
	$('#tokenfield').tokenfield()
</script>
