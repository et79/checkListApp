<h1>
	Projects
</h1>

<% if user_signed_in? then %>

	<div class="panel panel-default">
		<div class="panel-heading">
	    	<h3 class="panel-title">プロジェクトの作成</h3>
	  	</div>
		<div class="panel-body">
			
			<!-- 新規作成フォーム -->
			<%= form_for @projects.build, html: {class: "navbar-form"} do |f| %>
				<div class="input-group">
					<%= f.text_field :title, class: "form-control", placeholder: "プロジェクト名" %>
					<span class="input-group-btn">
						<button type="submit" class="btn btn-default">
							<i class="glyphicon glyphicon-plus"></i> Create
						</button>
					</span>
				</div>
			<% end %>	  
		</div>
	</div>

<% end %>

<!-- 自分のプロジェクトのみ表示 -->
<p>
	<label>
		<%= check_box_tag '','',session[:my_proj_only], {'data-name' => 'my_proj_only'} %> 自分のプロジェクトのみ表示
	</label>
</p>

<table class="table table-striped table-hover">
	<tbody>
		<% if user_signed_in? and session[:my_proj_only] == true then %>
			<!-- 自分のプロジェクトのみ表示 -->
			<% @projects.where(user_id: current_user.id).each do |project| %>
				<%= render 'proj_item_row', project: project, locals: { user_signed_in?: user_signed_in? } %>
			<% end %>
		<% else %>
			<!-- 全てのプロジェクトを表示 -->
			<% @projects.each do |project| %>
				<%= render 'proj_item_row', project: project, locals: { user_signed_in?: user_signed_in? } %>
			<% end %>
		<% end %>
	</tbody>
</table>

<script>
$(function() {
	$("input[type=checkbox]").click(function(){
		$.post('/projects/toggle/'+$(this).data('name'));
	});
});
</script>